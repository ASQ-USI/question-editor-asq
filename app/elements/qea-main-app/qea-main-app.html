<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="../qea-questions-list/qea-questions-list.html">
<link rel="import" href="../../bower_components/paper-toast/paper-toast.html">
<link rel="import" href="../qea-canvas/qea-canvas.html">
<link rel="import" href="../qea-feature-editor/qea-feature-editor.html">

<dom-module id="qea-main-app">
  <template>
    <style>
      :host {
        display: block;
      }
      #toast{
      }

      paper-toolbar{
        --paper-toolbar-background: white;
        --paper-toolbar-color: black;
      }

      #canvas-container{
        position: absolute;
        top: 64px;
        left: 0;
        bottom: 0;
        right: 300px;
      }
      #nav-container{
        background: #fafafa;
        border-left: 1px solid #999;
        position: fixed;
        width: 300px;
        top: 0;
        right: 0;
        bottom: 0;
      }

    </style>

    <paper-toolbar>
      <span class="title">question-editor-asq</span>
    </paper-toolbar>

    <section id="canvas-container">
      <qea-canvas id="qea-canvas"
        dropped-elem={{dropped}}
        is-dragging={{isDragging}}>
      </qea-canvas>
    </section>

    <nav id="nav-container">
      <qea-questions-list id="questions-list"></qea-questions-list>
      <qea-feature-editor></qea-feature-editor>
    </nav>

    <paper-toast id="toast" text={{toastMessage}} duration='3000' ></paper-toast>

  </template>
  <script>
  (function() {
    'use strict';

    class qeaMainApp {
      beforeRegister() {
        this.is = 'qea-main-app';

        this.listeners = {
          "fireToast": "openToast",
          "dragStart": "_dragStart",
          "dragStop" : "_dragStop"
        },

        this.properties = {
          toastMessage: {
            type: String,
            value: ''
          },
          isDragging: {
            type: Boolean,
            value: false
          },
          dropped: {
            type: Object,
            notify: true
          }
        }
      }
      openToast(host, messageData) {
        this.toastMessage = messageData.text;
        this.$.toast.open();
      }

      _dragStart(host){
        // receive the event from question-item when drag start
        this.isDragging = true;
      }

      _dragStop(host, droppedElem) {
        // receive the event from question-item when drag stop
        this.isDragging = false;
        if (droppedElem) {
          // render the dropped element
          this.dropped = droppedElem;
        }

      }

    }
    Polymer(qeaMainApp);
  })();

  </script>
</dom-module>
