<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-toggle-button/paper-toggle-button.html">

<dom-module id="attributes-editor">
  <template>
    <style>
      :host {
        display: block;
        height: 100%;
        color: rgba(0, 0, 0, 0.7);
      }
      .property-container{
        height: calc(100% - 64px);
        overflow: auto;
      }
      .property{
        margin: 3px 0;
        /*border-bottom: 1px solid gray;*/

      }
      .label{
        /*color: indigo;*/
      }
      .setter{
        padding-left: 15px;
        max-width: 70%;
      }

    </style>
    <div class="property-container">
      <template is="dom-repeat" items="[[propArray]]">
        <div class="property">
          <div class="label">
            <span>[[item.name]]</span>
            <paper-icon-button icon="info-outline" on-tap='_showInfo'></paper-icon-button>
          </div>
          <template is="dom-if" if="{{_isString(item.type)}}">
            <div class="setter">
              <paper-input label="Input label"
                no-label-float data=[[item.name]]
                on-change="_updateStringProp"></paper-input>
            </div>
          </template>
          <template is="dom-if" if="{{_isBoolean(item.type)}}">
            <div class="setter">
              <paper-toggle-button on-change='_updateBoolProp' data=[[item.name]]></paper-toggle-button>
            </div>
          </template>

        </div>
      </template>
    </div>


  </template>
  <script>
    Polymer({
      is: 'attributes-editor',
      properties: {
        propArray: {
          type: Array
        }
      },

      _isString: function (value) {
        return value === 'String'
      },
      _isBoolean: function (value) {
        return value === 'Boolean'
      },

      loog: function () {
        console.log(this.propArray);
      },

      _showInfo: function (e) {
        var item = e.model.item;
        alert(item.desc)
      },

      _updateBoolProp: function (e) {
        this.fire("changeProp", {name: e.target.data, value:e.target.checked })
      },

      _updateStringProp: function (e) {
        var target;
        for (var i = 0; i < e.path.length; i++) {
          if(e.path[i].tagName == 'PAPER-INPUT'){
            target = e.path[i];
            break;
          }
        }
        this.fire("changeProp", {name: target.data, value:e.target.value })
      }


    });
  </script>
</dom-module>
