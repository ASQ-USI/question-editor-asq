<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <script src="../../bower_components/webcomponentsjs/webcomponents-lite.js"></script>
    <script src="../../bower_components/web-component-tester/browser.js"></script>
    <script src="../../.transpiled/script/redux.min.js"></script>
    <link rel="import" href="../../bower_components/polymer-redux/polymer-redux.html">


    <!-- <link rel="import" href="../../.transpiled/elements/elements.html"> -->
    <link rel="import" href="../../.transpiled/behaviors/qea-redux-store.html">
    <link rel="import" href="../../.transpiled/behaviors/qea-actions-behavior.html">
    <link rel="import" href="../../.transpiled/elements/qea-canvas/qea-canvas.html">
    <link rel="import" href="../../bower_components/qea-property-editor/qea-advanced-code-editor.html">
    <link rel="import" href="../../bower_components/qea-property-editor/qea-advanced-text-editor.html">
    <link rel="import" href="../../.transpiled/elements/qea-selector-highlighter/qea-selector-highlighter.html">
    <link rel="import" href="../../bower_components/Sortable/Sortable.html">



  </head>
  <body>
    <!-- use the document as a place to set up your fixtures -->
    <test-fixture id="qea-canvas-fixture">
      <template>
        <qea-canvas></qea-canvas>
      </template>
    </test-fixture>
    <script>
      suite('<qea-canvas>', function() {
        var myEl;
        setup(function() {
          myEl = fixture('qea-canvas-fixture');
        });

        test('insertTextArea opens the text editor', function(done) {
          assert.equal(myEl.$$('qea-advanced-text-editor').$$('paper-dialog').opened, false);
          myEl.insertTextArea();
          flush(function () {
            assert.equal(myEl.$$('qea-advanced-text-editor').$$('paper-dialog').opened, true);
            done();
          })
        });

        test('showCode opens the code editor', function(done) {
          assert.equal(myEl.$$('qea-advanced-code-editor').$$('paper-dialog').opened, false);
          myEl.showCode();
          flush(function () {
            assert.equal(myEl.$$('qea-advanced-code-editor').$$('paper-dialog').opened, true);
            done();
          })
        });

        test('set droppedElem fires changePage event', function (done) {
          myEl._onHovered();
          myEl.addEventListener('changePage', function(event) {
            assert.equal(event.detail.selectedPage, 'questionEditor');
            assert.notEqual(event.detail.pageData, undefined);
            assert.equal(event.detail.pageData.bowerName, 'asq-text-input-q-editor');
            assert.equal(event.detail.pageData.label, 'text input');
            done();
          });
          myEl.droppedElem = {dragDetails: {}, questionDetails: {bowerName: 'asq-text-input-q-editor', label:'text input'} };
        })


      });
    </script>
  </body>
</html>
